# Chapter 04. 추측통계의 기본

2장과 3장에서는 우리 주변에서 쉽게 찾을 수 있는 데이터가 어떤 성질을 갖는지 설명하는 방법에 대해 배웠습니다. 평균이나 분산 등의 지표에 따라 정리하거나 그래프를 이용해 시각화한 것은 데이터를 직관적으로 이해할 수 있는 강력한 도구임을 실감할 수 있습니다. 그러나 때로는 가까운 데서 찾을 수 있는 데이터뿐 아니라 그 뒤에 있는 대규모 데이터가 어떤 통계적 성질을 띠고 있는지 알고 싶은 경우도 있습니다.

예를 들어, 다음과 같은 상황을 생각해봅시다.

어느 고등학교에서 전교생 400명이 수학 시험을 동일하게 치렀습니다. 3학년인 A학생은 이 시험에서 80점을 받았지만, 학교에서 전교생의 평균 점수를 알려주지 않았기 때문에 A 학생은 자신이 전교생 중 어느 정도의 수준인지 알지 못합니다. 자신의 성적이 좋은지 나쁜지가 궁금한 A 학생은 스스로 전교생의 평균 점수를 구해보려 했지만, 400명 전원의 시험 결과를 수소문하는 것은 무리입니다. 그래서 A학생은 학교 안에서 우연히 만난 20명에게 시험 점수를 물어보고, 그 결과로부터 전교생의 평균 점수를 추측하기로 했습니다.

20명의 시험 점수 평균은 70.4점이었습니다. A 학생은 전교생의 평균도 그 정도일 것으로 생각하고, 자신의 점수가 평균보다 위에 있다는 것에 만족했습니다.

이처럼 일부 데이터로부터 전체의 통계적 성질을 추측하는 방식이 **추측통계**입니다. 추측통계와 비교하여 2장과 3장에서 다룬 통계를 **기술통계**라고 합니다.

이 주제를 시작하기 전에 라이브러리와 데이터를 준비합시다.

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

%precision 3
%matplotlib inline
```



전교생의 데이터는 ch4_scores400.csv에 있습니다.

```python
df = pd.read_csv('ch4_scores400.csv')
scores = np.array(df['score'])
scores[:10]
```

```
array([76, 55, 80, 80, 74, 61, 81, 76, 23, 80], dtype=int64)
```



## 01. 모집단과 표본

추측통계에서는 관측 대상의 전체의 통계적 성질을 그 관측 대상의 일부분만 사용하여 추측합니다.  이때, 추측하고 싶은 관측 대상 전체를 **모집단**(population)이라 하고, 추측에 사용하는 관측 대상의 일부분을 **표본**(sample)이라 합니다. 또 모집단에서 표본을 골라내는 일을 **표본추출**(sampling)이라 하고, 골라낸 표본의 수를 **표본 크기** 또는 **샘플 사이즈**라고 합니다. 그러나 표본을 바탕으로 계산한 평균이나 분산, 상관계수 등을 **표본 통계량**이라 하고, 모집단의 평균이나 분산, 상관계수 등을 **모수**라고 합니다. 표본의 평균을 표본평균, 모집단의 평균을 모평균 등으로 부르는 경우도 있습니다. 정리하면 다음과 같습니다.

![4-1](image/4/4-1.png)

앞에서 살펴본 예에 적용하면, 전교생 400명의 시험 점수가 모집단이 됩니다. A 학생이 학교에서 우연히 만난 20명의 시험 점수가 표본으로 추출된 점수들입니다. 이 표본을 대상으로 표본 평균이라는 표본통계량을 사용해서 학교 전체의 평균 점수인 모평균이라는 모수를 추측한 것입니다.

이와 같이 표본평균으로 모평균을 추측할 때, 표본평균은 모평균의 **추정량**(estimator)이라고 합니다. 그리고 실제로 표본의 데이터를 이용하여 계산한 결과를 **추정값**(estimate)이라고 합니다. A학생은 모평균의 추정량으로 표본평균을 선택하여, 추정값을 70.4점으로 한 것입니다.



### 1.1 표본추출 방법

표본은 학교 안에서 우연히 만난 20명의 점수였습니다. 이 '우연히 만난 것'은 추측통계에서 매우 중요한 역활을 합니다. 우연히 만난 20명에게 시험 결과를 듣는 것과 A 학생과 친하게 지내는 친구 20명에게 시험 결과를 듣는 것은 어떤 차이가 있을까요?

A 학생은 자신과 친하게 지내는 친구 20명에게 표본을 얻는 상황을 생각해볼 수 있습니다. A학생의 친구는 아마 A학생과 같은 3학년이 대부분일 것입니다. 3학년은 1학년이나 2학년 학생에 비해 높은 점수를 얻을 것으로 생각되므로, A학생이 자기 친구들에게 물어서 얻는 표본평균은 전교생의 평균 점수보다 높아질 것입니다. 이 방법으로는 전교생의 평균 점수가 올바르게 추측되었다고 할 수 없습니다.

같은 학년의 친구를 표본으로 선택한다는 가정이 조금 극단적인 예라고 생각할 수도 있습니다. 그러나 설령 A 학생과 같은 동아리에 속한 여러 학년의  학생에게서 표본을 추출하는 방법이라해도 같은 동아리라는 편향이 생기므로 이 방법으로 추측한 평균 점수도 그다지 올바른 추측은 아니라고 할 수 있습니다. 학교 전체의 평균 점수를 잘 추측하려면 어떻게 해서든 다양한 학년의 학생들, 여러 동아리에서 활동하는 학생들, 다양한 취미 생활을 하는 학생들에게 점수를 물어서 편향되지 않는 것이 중요합니다. 이를 위해 A 학생은 표본을 '우연히 만나는' 학생들에게서 모음으로써 표본추출이 편향되지 않도록 미리 작전을 세운 것입니다. 이처럼 임의로 표본을 추출하는 방법을 **무작위 추출**(random sampling) 이라 합니다.

무작위추출이 표본을 추출할 때 편향을 없애는 방법이긴 하지만, 그 결과로 편향이 있는 데이터를 얻을 수도 있다는 점에 주의해야 합니다. 즉, '우연히 만난 사람'이 공교롭게도 전부 3학년일 수도 있습니다. 그런 데이터를 얻게 되면 다시 한 번 무작위추출을 하고 싶겠지만, 그렇게 하면 작위적인 추출이 되고 맙니다. 추측통계에서는 무작위추출의 결과로 편향이 있는 표본이 얻어질 가능성도 포함해서 추측하므로 안심하기 바랍니다. 이에 대해서는 4.3절에서 자세히 다룹니다.

한편, '우연히 만나는' 방법을 썼을 때 같은 사람에게 여러번 시험 결과를 들을 가능성도 있습니다. 같은 사람에게 같은 질문을 여러 번 하면 의아한 눈으로 쳐다보겠지만, 추출 방법의 관점에서 보면 전혀 문제가 되지 않습니다. 이처럼 여러 차례 동일한 표본을 선택하는 추출 방법을 **복원추출**(sampling with replacement)이라 하고, 동일한 표본은 한 번만 선택하는 방법을 **비복원추출**(sampling without replacement)이라 합니다.

파이썬으로 무작위 추출을 해봅시다. 무작위추출에는 np.random.choice 함수가 사용됩니다. 첫번째 인수가 추출 대상이 되는 리스트, 두번째 인수가 표본크기입니다. 시험 삼아 [1, 2, 3]이라는 리스트에서 표본 크기 3으로 무작위 추출을 해봅시다.

```python
np.random.choice([1, 2, 3], 3)
```

```
array([1, 1, 2])
```



무작위추출이란 임의의 결과가 수반되는 계산이므로, 동일한 결과를 얻지 못할 수도 있습니다. 따라서 이 셀은 실행할 때마다 결과가 달라집니다. 여러 번 실행해보기 바랍니다. 실행 결과를 보면 1, 2, 3이라는 숫자가 한 번씩 추출되는 경우도 있겠지만, 동일한 숫자가 여러번 추출되는 경우도 있을 겁니다. 즉, np.random.choice 함수는 기본 설정으로 복원추출을 수행하고 있습니다.

그렇다면 비복원추출을 하려면 어떻게 해야 할까요? np.random.choice의 인수 replace를 False로 하면 비복원추출을 실행할 수 있습니다.

```python
np.random.choice([1, 2, 3], 3, replace = False)
```

```
array([1, 2, 3])
```



이 셀도 여러번 실행해보기 바랍니다. 매번 중복되지 않고 1, 2, 3이라는 숫자가 한 번씩 추출됩니다.

무작위추출을 하는 방법은 알았지만, 저와 여러분의 계산 결과가 다르다는 것이 문제입니다. 이 문제를 해결하기 위해 난수 시드(seed)를 도입합니다. 난수 시드는 이제부터 발생하는 난수의 근원이 되는 숫자로, 이것을 정해두면 매번 동일한 난수를 얻을 수 있습니다.

시드를 0으로 하여 무작위추출을 실행해봅시다.

```python
np.random.seed(0)
np.random.choice([1, 2, 3], 3)
```

```
array([1, 2, 1])
```



여러분도 저와 동일한 결과를 얻었으리라 생각합니다. 위의 셀을 몇 번 실행해보면 동일한 결과가 나타나는 것을 확인할 수 있습니다. 이처럼 시드를 설정하면 매번 동일한 난수를 얻게 되어 코드의 재현성을 유지할 수 있습니다.

A 학생이 수행한 무작위추출에 대해 np.random.seed(0)을 지정한 다음, scores로부터 표본 크기 20으로 복원추출하여 재현했습니다. 무작위추출을 실행하여 표본평균을 계산해봅시다.

```python
np.random.seed(0)
sample = np.random.choice(scores, 20)
sample.mean()
```

```
70.4
```



우리는 전교생의 시험 점수 데이터도 가지고 있기 때문에, A 학생이 추측하고 싶은 모평균도 계산할 수 있습니다.

```python
scores.mean()
```

```
69.53
```



모평균이 69.53점이므로, A 학생이 수행한 70.4점이라는 추측은 꽤 괜찮은 결과로 보입니다.

무작위추출은 실행할 때마다 결과가 달라지기 때문에, 얻어진 표본평균도 매번 달라집니다. 무작위추출과 그에 따른 표본평균 계산을 몇 번 실행해봅시다.

```python
for i in range(5):
    sample = np.random.choice(scores, 20)
    print(f'{i+1}번째 무작위 추출로 얻은 표본평균', sample.mean())
```

```
1번째 무작위 추출로 얻은 표본평균 72.45
2번째 무작위 추출로 얻은 표본평균 63.7
3번째 무작위 추출로 얻은 표본평균 66.05
4번째 무작위 추출로 얻은 표본평균 71.7
5번째 무작위 추출로 얻은 표본평균 74.15
```

표본평균은 대체로 70점 전후이지만, 나름대로 산포도도 나타내는 것 같습니다.



## 02. 확률 모형

무작위추출은 임의의 표본을 선택하는 것이므로, 실행해볼 때까지는 어떤 결과가 나올지 알 수 없습니다. 어제 실행한 무작위추출과 오늘 실행한 무작위추출의 결과가 다르고, 그 결과로부터 내일의 결과를 알아맞힐 수도 없습니다. 이렇게 실행할 때마다 결과가 다르면 언뜻 다루기 어렵다고 생각할 수 있지만, 그러한 사례는 주변에 넘쳐납니다.

이처럼 불확정성을 수반한 현상을 해석하기 위해 **확률**(probability)을 사용합니다. 확률을 사용한 무작위 추출 혹은 주사위를 모델링한 것을 **확률 모형**(probability model)이라고 합니다.(모델은 모형입니다. 따라서 모델링은 현상을 모형처럼 취급하여 특징을 잘 파악하도록 단순화하는 것을 가리킵니다. 모델링을 실행함으로써 복잡한 현상을 분석할 수 있게 됩니다.)



### 2.1 확률의 기본

주사위를 굴릴 때 어떤 숫자가 나올지 알아맞힐 수 없습니다. 그러나 주사위 눈이 숫자 1부터 6까지임을 알고 있으며, 각각은 동일한 비율로 나온다는 것도 경험적으로 알고 있습니다. 이와 같이 결과를 알아맞힐 수 는 없지만, 취하는 값과 그 값이 나올 확률이 결정되어 있는 것을 **확률변수**(random variable)라고 합니다.

주사위를 굴릴 때까지 어떤 눈이 나올 지 알 수 없지만, 주사위를 굴리면 눈은 하나씩 확정됩니다. 이와 같이 확률변수의 결과를 관측하는 것을 **시행**(trial)이라 하고, 시행에 의해 관측되는 값을 **실현값**(realization)이라고 합니다. 또한 '눈이 1'이나 '눈이 홀수'처럼 시행결과로 나타날 수 있는 일을 **사건**(event)이라고 합니다. 특히, '눈이 1'처럼 더 세부적으로 분해할 수 없는 사건을 **근원사건**(elementary event)이라고 합니다. 확률을 사건에 대해서 정의되는데. '눈이1'이라는 사건에 대한 확률을 1/6, '눈이 홀수'라는 사건에 대한 확률은 1/2이라는 식으로 대응됩니다.

다음으로 확률을 수식으로 표현하는 방법을 살펴봅시다. 주사위의 눈을 확률변수 X라고 합니다. 이때, '눈이 1'이 되는 사건의 확률이 1/6이라는 것은 다음과 같이 표현합니다.

<img src="image/4/4-2.png" alt="4-2" style="zoom:80%;" />

'눈이 홀수'라는 사건의 확률은 어떻게 표현될까요? 홀수는 주사위의 눈 중에서 절반에 해당하므로, 직감적으로 1/2이라는 것을 알 수 있습니다. 수식으로는 다음과 같이 표현합니다.

<img src="image/4/4-3.png" alt="4-3" style="zoom:80%;" />

여기서 (X=1) ∪ (X=3) ∪ (X=5)는 '눈이 1' 또는 '눈이 3' 또는 '눈이 5'가 나오는 사건을 나타냅니다. 이것이 '눈이 1', '눈이 3', '눈이 5'일 때 각각의 확률을 더한 것임을 수식의 첫번째 줄에서 나타내고 있지만, 여기에는 중요한 확률의 성질이 숨어 있습니다. 그것은 '사건이 서로 배반이라면, 그중에 적오도 하나 일어나는 사건은 각 사건의 확률의 합과 같다.'라는 성질입니다.

사건이 **상호배반**(mutually exclusive)이라는 것은 각 사건이 동시에는 일어날 수 없다는 말입니다. 예를 들어, '눈이 1또는 2또는 3'이라는 사건과 '눈이 6'이라는 사건은 동시에 일어 날 수 없기 때문에 상호배반이다.  상호배반이 아닌 예는 '눈이 1 또는 2 또는 3' 이라는 사건과 '눈이 짝수'라는 사건인 경우로, 이 경우 눈이 2가 나오면 양쪽 사건이 동시에 일어날 수 있습니다.

'눈이 홀수'라는 사건의 확률이 1/2이 되는 이유는, '눈이 1'과 '눈이 3'과 '눈이 5'는 상호배반이므로 각각의 확률을 더하여 구할 수 있기 때문입니다.



### 2.2 확률분포

**확률분포**(probability distribution)란 확률변수가 어떻게 움직이는지를 나타낸 것입니다. 전체 확률이 1인 확률변수가 취할 수 있는 값이 어떻게 분포하고 있는지 나타낸다고 할 수 있습니다. 주사위의 눈이라면 다음과 같은 확률분포가 됩니다. 이때 주사위의 눈을 확률 변수 X, 다음 확률분포를 A라 하면 '확률변수 X는 확률분포 A를 따른다.' 라고 합니다. 수식으로 X~A로 나타낼 수 있습니다.

|  눈  |  1   |  2   |  3   |  4   |  5   |  6   |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| 확률 | 1/6  | 1/6  | 1/6  | 1/6  | 1/6  | 1/6  |



지금까지, 주사위의 눈은 당연히 모든 눈이 각각 동일한 확률로 나온다는 전제로 이야기했습니다. 사실 주사위의 눈이 각각 동일한 확률로 나오려면 무게 중심이 정확하게 중심에 있어야 합니다. 무게중시미 어긋나면, 특정한 눈이 더 잘 나오는 편향이 생깁니다. 결국 무게중심을 변경하는 것만으로도 특정한 눈이 나오기 쉬운 불공정한 주사위를 만들 수 있습니다.

눈앞에 그런 불공정한 주사위가 있다고 해봅시다. 여러분은 이 주사위가 불공정하다는 것을 알지만, 각 눈이 어느 정도의 확률로 나오는지는 알지 못합니다. 어떻게 하면 이 불공정한 주사위의 확률분포를 알 수 있을까요?

주사위의 형태를 잘 관찰했더라도, 어느 눈이 어떤 확률로 나오는지는 알 수 없습니다. 무게중심을 측정하여 물리연산을 해볼 수도 있겠지만, 보통은 단순히 주사위를 몇 번 굴려, 그 눈의 비율을 확률분포로 추측하지 않을까요?

이제부터는 불공정한 주사위의 확률분포를 구하기 위한 실험을 파이썬으로 수행해보려합니다. 여기서 불공정한 주사위는 다음의 확률분포를 따르고, 특정한 눈이 나오기 쉬운 주사위라고 합시다.

|  눈  |  1   |  2   |  3   |  4   |  5   |  6   |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| 확률 | 1/21 | 2/21 | 3/21 | 4/21 | 5/21 | 6/21 |



우선 확률변수에 필요한 변수가 취할 수 있는 값과 그 값이 나오는 확률을 정희합시다.

```python
dice = [1, 2, 3, 4, 5, 6]
prob = [1/21, 2/21, 3/21, 4/21, 5/21, 6/21]
```



확률변수를 시행할 때 np.random.choice 함수를 사용할 수 있습니다. 그리고 인수 p에 prob를 넘겨주는 것으로 각 확률을 지정합니다. 한 번 시행해보겠습니다.

```python
np.random.choice(dice, p = prob)
```



실현값은 1이 되었습니다. 다음에는 100번 시행해봅시다.

```python
num_trial = 100
sample = np.random.choice(dice, num_trial, p = prob)
sample
```

```
array([4, 6, 4, 5, 5, 6, 6, 3, 5, 6, 5, 6, 6, 2, 3, 1, 6, 5, 6, 3, 4, 5, 3, 4, 3, 5, 5, 4, 4, 6, 4, 6, 5, 6, 5, 4, 6, 2, 6, 4, 5, 3, 4, 6, 5, 5, 5, 3, 4, 5, 4, 4, 6, 4, 4, 6, 6, 2, 2, 4, 5, 1, 6, 4, 3, 2, 2, 6, 3, 5, 4, 2, 4, 4, 6, 6, 1, 5, 3, 6, 6, 4, 2, 1, 6, 4, 4, 2,
4, 1, 3, 6, 6, 6, 4, 5, 4, 3, 3, 4])
```



2.4절에서 설명한 도수분포표를 작성해봅시다.

```python
freq, _ = np.histogram(sample, bins = 6, range = (1, 7))
pd.DataFrame({'frequency': freq,
              'relative frequency': freq / num_trial},
            index = pd.Index(np.arange(1,7), name = 'dice'))
```

<img src="image/4/4-4.png" alt="4-4" style="zoom:80%;" />

도수분포표를 통해, 각 눈이 나온 횟수와 비율을 알 수 있습니다.

실제의 확률분포와 함께 히스토그램을 그려봅시다.

```python
fig = plt.figure(figsize = (10, 6))
ax = fig.add_subplot(111)
ax.hist(sample, bins = 6, range = (1, 7), density = True, rwidth = 0.8)
# 실제의 확률분포를 가로선으로 표시
ax.hlines(prob, np.arange(1, 7), np.arange(2,8), colors = 'gray')
# 막대그래프의 [1.5, 2.5, ..., 6.5]에 눈금을 표시
ax.set_xticks(np.linspace(1.5, 6.5, 6))
# 주사위 눈의 값은 [1, 2, 3, 4, 5, 6]
ax.set_xticklabels(np.arange(1, 7))
ax.set_xlabel('dice')
ax.set_ylabel('relative frequency')
plt.show()
```

<img src="image/4/4-5.png" alt="4-5" style="zoom:80%;" />



100번 시행하여 얻은 눈의 상대도수로부터 추측된 확률분포와 실제의 확률분포 사이에는 상당한 차이가 있는 것 같습니다. 다시 시행 횟수를 늘려 10000번을 시행하고 이때의 히스토그램을 살펴봅시다.

```python
num_trial = 10000
sample = np.random.choice(dice, size = num_trial, p = prob)

fig = plt.figure(figsize = (10, 6))
ax = fig.add_subplot(111)
ax.hist(sample, bins = 6, range = (1, 7), density = True, rwidth = 0.8)
# 실제의 확률분포를 가로선으로 표시
ax.hlines(prob, np.arange(1, 7), np.arange(2,8), colors = 'gray')
# 막대그래프의 [1.5, 2.5, ..., 6.5]에 눈금을 표시
ax.set_xticks(np.linspace(1.5, 6.5, 6))
# 주사위 눈의 값은 [1, 2, 3, 4, 5, 6]
ax.set_xticklabels(np.arange(1, 7))
ax.set_xlabel('dice')
ax.set_ylabel('relative frequency')
plt.show()
```

<img src="image/4/4-6.png" alt="4-6" style="zoom:80%;" />

상대도수(relative frequency)가 실제의 확률분포에 가까워졌습니다. 이대로 시행 횟수를 점점 늘리면, 상대도수는 확률분포로 수렴되어 갑니다. 제공한 소스코드 중 animation 폴더 안의 자료로 상대도수가 실제의 확률분포로 수렴되는 애니메이션을 확인할 수 있습니다.

확률변수 시행을 시뮬레이션하여 그 결과를 시각화하는 것은 어찌 보면 작위적인 방법이지만 직관적으로 이해할 수 있게 도와줍니다. 이런 작업을 간단히 할 수 있다는 것이 파이썬을 이용해 확률과 통계를 학습하는 큰 장점입니다.



## 03. 추측통계의 확률

앞 절에서는 주사위를 사용하여 확률 모형에 관해 설명했습니다. 추측통계에서도 마찬가지로 무작위추출을 확률 모형으로 기술할 수 있고, 무작위추출로 얻은 표본은 모집단의 확률분포를 따르는 확률변수로 간주할 수 있습니다. 따라서 추측통계에서 다루는 데이터는 그와 같은 확률변수의 실현값이라고 생각할 수 있습니다.

이 장의 맨 처음에 제시한 예를 확률 모형으로 생각해봅시다. 우선 전교생의 시험 점수(score)가 어떻게 분포되어 있는지 알기 위해 계급폭을 1점으로 하여 히스토그램을 그려보겠습니다.

```python
fig = plt.figure(figsize = (10, 6))
ax = fig.add_subplot(111)
ax.hist(scores, bins = 100, range = (0, 100), density = True)
ax.set_xli![4-7](image/4/4-7.png)m(20, 100)
ax.set_ylim(0, 0.042)
ax.set_xlabel('score')
ax.set_ylabel('relative frequency')
plt.show()
```

<img src="image/4/4-7.png" alt="4-7" style="zoom:80%;" />

위 그림을 보면 69점을 얻은 학생은 전교생의 0.04를 차지하고 있습니다. 따라서 무작위 추출을 수행하면 4%의 확률로 69점이라는 표본 데이터를 얻게 됩니다.(이 책에서는 데이터가 표본의 실현값임을 강조하고 싶을 때 표본 데이터라는 용어를 사용합니다.) 이런 결과를 다른 점수에 관해서도 마찬가지로, 상대도수(relative frequency)는 해당점수를 얻는 확률에 대응합니다. 결국 이 히스토그램을 모집단의 확률분포로 간주 할 수 있습니다.

무작위추출은 이와 같이 확률분포를 따르는 확률변수의 시행입니다. 시험 삼아 한 번 시행해봅시다.

```python
np.random.choice(scores)
```

```
89
```

89점이라는 실현값을 얻었습니다. 이것은 무작위추출로 얻은 표본 데이터가 89점이었다고 해석할 수 있습니다.

주사위의 상대도수가 시행 횟수를 늘리면 실제의 확률분포에 가까워진 것처럼, 무작위추출에서도 표본의 크기가 커지면, 표본 데이터의 상대도수는 실제의 확률분포에 가까워집니다. 여기서는 무작위추출로 샘플 사이즈가 10000인 표본을 추출하여, 그 결과를 히스토그램으로 그려봅시다.

```python
sample = np.random.choice(scores, 10000)

fig = plt.figure(figsize = (10, 6))
ax = fig.add_subplot(111)
ax.hist(sample, bins = 100, range = (0, 100), density = True)
ax.set_xlim(20, 100)
ax.set_ylim(0, 0.042)
ax.set_xlabel('score')
ax.set_ylabel('relative frequency')
plt.show()
```

<img src="image/4/4-8.png" alt="4-8" style="zoom:80%;" />



히스토그램이 실제의 점수 분포에 매우 가까운 형태임을 알 수 있습니다. 표본 크기가 커지면, 실제의 분포에 수렴됩니다.

마지막으로 표본평균에 관해서 생각해보겠습니다. 표본 하나하나가 확률변수이므로, 표본들의 평균으로 계산되는 표본평균도 역시 확률변수이다. 여기서는 무작위 추출로 표본 크기가 20인 표본을 추출하여 표본평균을 계산하는 작업을 10000번 수행해서, 그 결과를 히스토그램으로 그려 표본평균이 어떻게 되는지 살펴보겠습니다.

```python
sample_means = [np.random.choice(scores, 20).mean() for _ in range(10000)]

fig = plt.figure(figsize = (10, 6))
ax = fig.add_subplot(111)
ax.hist(sample_means, bins = 100, range = (0, 100), density = True)
# 모평균을 세로선으로 표시
ax.vlines(np.mean(scores), 0, 1, 'gray')
ax.set_xlim(50, 90)
ax.set_ylim(0, 0.13)
ax.set_xlabel('score')
ax.set_ylabel('relative frequency')
plt.show()
```

<img src="image/4/4-9.png" alt="4-9" style="zoom:80%;" />

위에 그림에서 가운데의 세로선이 모평균입니다. 표본평균은 산포도 그 자체이므로, 모평균을 중심으로 분포하는 것을 알 수 있습니다. 이것이 무작위추출에 의한 표본평균으로 모평균을 추측할 수 있는 근거입니다. 표본평균의 분포에 관해서는 9.3절에서 상세히 살펴보겠습니다.



## 04. 앞으로 배울 내용

이 장을 통해, 추측통계는 확률을 사용하여 모집단의 통계적 성질을 추측하는 기법임을 알게 되었습니다. 5장부터는 확률과 추측통계에 관해 더욱 상세히 설명한다

우선, 5~9장에서는 확률변수의 정의와 대표적인 확률분포에 대해서 다룹니다. 확률은 추측통계에서 매우 중요한 도구이지만, 확정되지 않은 추상저인 것을 다루기 때문에 이미지를 떠올리기 어려운 분야입니다. 그래서 이 책에서는 확률을 설명할 때 먼저 수식으로 정의한 다음 구체적인 예를 파이썬으로 구현하고, 시뮬레이션과 그림을 섞어서 설명합니다. 특히 파이썬을 이용해 확률을 배울 때 가장 큰 장점은 시뮬레이션을 해볼 수 있다는 점입니다. 시뮬레이션은 펜과 노트를 사용하는 공부로는 할 수 없는 작업입니다.

본격적인 추측통계는 10~12장에서 살펴봅니다. 추측통계는 크게 추정과 검정으로 나눌 수 있고, 이는 각각 10장과 11장에서 다룹니다.

**추정**(estimation)이란 모수를 추측하는 것 입니다. 하나의 값으로 추정하는 것을 **점추정**, 구간으로 추정하는 것을 **구간추정**이라고 부릅니다. 이 장의 맨 처음 예와 같이 모평균을 70.4점으로 하나의 값으로 추정하는 방법을 점추정에 해당합니다. 구간 추정은 예를 들어 '모평균은 68~72점 사이'라고 말하는 것으로, 범위를 가지고 추정하는 방법입니다.

**검정**(test)은 모집단의 통계적 성질에 대해 가설을 세우고, 그 가성이 옳은지 여부를 판단하는 기법입니다. 예를 들어, 어떤 주사위를 100번 굴린 결과가 어떤 도수분포표와 같이 되었다고 합시다. 이 주사위가 각 눈의 확률이 일반적인 주사위인지 여부를 확인하고 싶을 때 검정을 사용합니다. 이러한 경우, 주사위가 일반적인 주사위라는 가설을 세우고, 그 가설이 옳은지 여부를 통계학적으로 판정합니다.

12장에서는 앞에서 공부한 추측통계에 대한 응용으로, 여러 데이터 사이의 관계에 관해서 분석하는 기법인 회귀분석을 다룹니다. 예를 들면, 수면 시간에 따라 시험 점수가 변화했는지 여부를 알아볼 때, 어느 정도의 수면 시간이 시험 점수에 영향을 미치는지를 추정하고, 수면 시간과 시험점수가 서로 관계없다는 가정에 대해서 검정을 시행합니다.

